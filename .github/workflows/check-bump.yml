name: Check bump

on:
  pull_request

jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          token: ${{ secrets.BUMPER_TOKEN }}

      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: 3.11

      - name: Run Python Script
        run: |
          last_version=$(git describe --tags --abbrev=0)
          python .github/workflows/bump.py "$last_version"
      - name: Set new version
        run: |
          new_version=${{ env.new_version }}
          echo "new_version is $new_version"

          if [ -n "$new_version" ]; then
            echo "New version detected"
          else
            echo "::error file=pyproject.toml::No new version! Are you sure you want to merge?"
          fi

        env:
          SUFFIX: ${{ github.event.inputs.suffix }}


